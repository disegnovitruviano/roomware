#!/bin/bash

LIB_PATH="$COMMUNICATOR_PATH/lib"
SRC_PATH="$COMMUNICATOR_PATH/src"
JAR_NAME="$COMMUNICATOR_NAME.jar"

# set the classpath

  # start with empty classpath
  unset CLASSPATH
  unset JARS

  # start with source path
  CLASSPATH="$SRC_PATH"

  # add all jars to the classpath
  LIB_JARS="`ls \"$LIB_PATH\"|grep '[.]jar$'`"
  for LIB_JAR in $LIB_JARS;
    do CLASSPATH="$LIB_PATH/$LIB_JAR:$CLASSPATH";
  done

  # add RoomWare classes
  CLASSPATH="$ROOMWARE_LIB:$CLASSPATH"
  export CLASSPATH


# compile the module source

  THIS_COMMUNICATOR_SOURCE_FILES=`find $SRC_PATH -name '*.java'`
  if "$JAVAC" $THIS_COMMUNICATOR_SOURCE_FILES; then : ; else exit; fi;


# build special client jar
  rm $SRC_PATH/applet.jar
  "$JAR" -cf $SRC_PATH/applet.jar -C $SRC_PATH $COMMUNICATOR_NAME/applet

# build jar out of source files

  JAR_ARGS="-cf $COMMUNICATOR_PATH/build/$JAR_NAME -C $SRC_PATH
$COMMUNICATOR_NAME -C $SRC_PATH applet.jar"
  "$JAR" $JAR_ARGS

